# AGENTS.md — エージェント行動規範

> **すべての指示を実行する前に、必ずこのファイルの全ルールを確認してから作業を開始すること。**

---

## 1. 基本方針

- 指示の実行前に本ファイルのルールを参照し、遵守を確認すること。
- 判断できない点・不明点が生じた場合は、**勝手に補完せず操作者（ユーザー）に確認を仰ぐこと**。
- Salesforce 関連の実装は、**常に最新の Salesforce 公式ドキュメント**に沿った正しいコードを記載すること。

---

## 2. コードレビュー規則

- フローのメタデータ・コードのレビューを依頼された場合、単体テストの観点だけでなく、**Git リポジトリに登録されている他の資材との結合観点**でも必要に応じてレビューを実施すること。
- 確認すべき結合観点の例：
  - 参照している Apex クラス・メソッドの存在と互換性
  - 呼び出し元 LWC・Flow との入出力の整合性
  - オブジェクト・項目 API 名の一致
  - 権限セット・プロファイルでのアクセス可否

---

## 3. プログラム実装規則

### 3-0. 実装着手前の要件整理（必須）

- プログラム実装に着手する前に、**必ず Planモードで要件を整理すること**。
- 実装に着手するにあたり、不明点や確定すべき事項がある場合は、**すべて操作者（ユーザー）に判断を仰ぐこと**。

### 3-1. ファイル冒頭への記載（必須）

すべての Apex クラス・LWC JS ファイルの冒頭に、以下を必ず記載すること。

```
/**
 * クラス名   ：<ClassName>
 * 処理概要   ：<概要>
 * 引数       ：<引数名> - <説明>（引数がある場合のみ）
 * 戻り値     ：<型> - <説明>（戻り値がある場合のみ）
 * 作成者     ：<操作者名>
 * 作成日     ：<YYYY.MM.DD>
 * バージョン ：1.0
 */
```

### 3-2. メソッド前への記載（必須）

各メソッドの直前に以下を記載すること。

```
/**
 * メソッド名 ：<methodName>
 * 処理概要   ：<概要>
 * 引数       ：<引数名> - <説明>（引数がある場合のみ）
 * 戻り値     ：<型> - <説明>（戻り値がある場合のみ）
 */
```

### 3-3. インラインコメント

- 処理ブロックの内容が一見して分かりにくい場合、適切なコメントを記載すること。
- 自明な処理にはコメント不要。

### 3-4. テストクラス

- テストクラスを生成する場合、**コードカバー率 80% 以上**を必ず達成すること。
- 正常系・異常系・境界値のテストケースを網羅すること。

---

## 4. Git / プルリクエスト規則

### 4-1. コミットコメント形式

```
[YYYY.MM.DD] <操作者名> <変更点を一言>
例: [2025.11.20] 岩垣 ItemSortController に並び替え保存メソッドを追加
```

### 4-2. プルリクエスト手順

1. PR 作成前に**必ず操作者の承認**を得ること。
2. 承認を得た後に PR を作成する。
3. 承認なしでの PR 作成・マージは禁止。

---

## 5. ドキュメント管理規則

| 操作者の指示 | 作成場所 | ファイル名 |
|---|---|---|
| 仕様書の作成を指示された場合 | `specs/` | `<対象処理名>.spec.md` |
| 機能要件の整理・作成を指示された場合 | `docs/` | `<機能名>.architecture.md` |
| 機能の変更・追加を記録するよう指示された場合 | `adr/` | `choice-<連番>.md`（例: `choice-001.md`） |

- 各フォルダの詳細な記載ルールは、各フォルダ内の `README.md` を参照すること。

---

## 6. フォルダ構成

```
/
├── AGENTS.md          # 本ファイル（エージェント行動規範）
├── force-app/         # Salesforce ソースコード
├── specs/             # 詳細仕様書
├── docs/              # 機能要件・アーキテクチャ
└── adr/               # アーキテクチャ決定記録
```
